story_mode_intro:
  llm: AliLLM
  template_path: markdown/story_mode_intro.md #路径为相对yaml文件的相对路径，或者直接给绝对路径
  type: "story"
  role: "assistant"
  max_tokens: 100

outline_generation:
  llm: AliLLM
  max_tokens: 600
  template_path: markdown/outline_generation.md
  type: "story"
  role: "user"
  schema:
    title: "StoryOutlineSchema"
    input:
      type: "object"
      required: ["theme", "age_group", "style"]
      properties:
        theme:
          type: "string"
          description: "用户指定的故事主题"
        age_group:
          type: "string"
          description: "目标年龄段"
        style:
          type: "string" 
          description: "故事风格"
    output:
      type: "object"
      required: ["title", "roles", "scene", "outline", "meaning"]
      properties:
        title:
          type: "string"
          description: "故事标题"
        roles:
          type: "array"
          description: "故事中的角色名称列表"
        scene:
          type: "string"
          description: "故事发生的场景和背景描述"
        outline:
          type: "string"
          description: "故事的情节大纲"
        meaning:
          type: "string"
          description: "故事的寓意，由于故事是针对儿童的，所以故事要有积极的教育意义，是一种深层次的寓意"

story_continuation:
  max_tokens: 1000
  llm: ChatGLMLLM
  template_path: markdown/story_continuation.md
  type: "story"
  role: "user"
  schema:
    title: "StoryContinuationSchema"
    input:
      type: "object"
      required: ["outline"]
      properties:
        outline:
          type: "string"
          description: "整个故事的大纲"
        before:
          type: "string"
          description: "已经生成的故事内容，用于故事续写，若为空则为首次创作"
        user_input:
          type: "string"
          description: "用户的输入或反馈"
    output:
      type: "object"
      required: ["story_seg", "ended"]
      properties:
        story_seg:
          type: "array"
          description: "故事分段，是一个数组，包含了故事的每一句话"
          items:
            type: "object"
            required: ["is_role", "content", "sort"]
            properties:
              is_role:
                type: "boolean"
                description: "是否为角色，true表示是角色，false表示旁白"
              role_name:
                type: "string"
                description: "角色名字，若为旁白则为空字符串，若为一群角色如'动物们'则需使用如'小狗A'或'小狗1'等方式区分"
              role_gender:
                type: "string"
                description: "角色性别，若为旁白则为空字符串，若为角色则需指定性别，如'female'或'male'"
              content:
                type: "string"
                description: "句子内容，如果是角色说的话只包含话语内容，不含情绪动作描述"
              sort:
                type: "integer"
                description: "顺序，该句子在文字转语音时播放的顺序，确保故事连贯性，顺序在整个故事的创作中是唯一且有序的，顺序从0开始"
              mood:
                type: "string"
                description: "角色说话的情绪和动作描述，仅当content是角色对话时有效"
              mood_location:
                type: "integer"
                description: "情绪动作位置，1表示在话语前面，2表示在话语后面"
        ended:
          type: "boolean"
          description: "故事是否已经结束"

story_theme_extraction:
  llm: AliLLM
  template_path: markdown/story_theme_extraction.md
  type: "story"
  role: "user"
  schema:
    title: "StoryThemeExtractionSchema"
    input:
      type: "object"
      required: ["text"]
      properties:
        text:
          type: "string"
          description: "用户的输入文本"
        user_info:
          type: "object"
          description: "关于用户的信息，包括记忆和对话历史"
    output:
      type: "object"
      required: ["theme", "age_group", "style", "has_explicit_theme"]
      properties:
        theme:
          type: "string"
          description: "推断的主题，如童话故事、科幻、冒险等"
        age_group:
          type: "string"
          description: "适合的年龄段，如儿童、青少年、成人"
        style:
          type: "string"
          description: "故事风格，如幽默、紧张、温馨等"
        user_summary:
          type: "string"
          description: "用户的相关信息总结，用以生成符合用户性格、特点、爱好、经历的故事"
        has_explicit_theme:
          type: "boolean"
          description: "用户是否明确指定了主题"

content_judge:
  llm: AliLLM
  template: markdown/content_judge
  type: "story"
  role: "user"
  schema:
    title: "ContentJudgeSchema"
    input:
      type: "object"
      required: ["text", "story_content"]
      properties:
        text:
          type: "string"
          description: "用户输入的文本"
        story_content:
          type: "string"
          description: "当前故事内容（摘要）"
    output:
      type: "object"
      required: ["is_relevant", "should_continue", "need_new_outline", "explanation"]
      properties:
        is_relevant:
          type: "boolean"
          description: "用户输入是否与当前故事相关"
        should_continue:
          type: "boolean"
          description: "是否应该继续讲故事"
        need_new_outline:
          type: "boolean"
          description: "是否需要根据用户输入调整故事大纲"
        explanation:
          type: "string"
          description: "判断理由的简要解释"
